<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="llh8,llh8.vip,llh8.vip有你/萝莉红吧,萝莉红.萝莉红在线, 萝莉">
    <meta name="keywords" content="llh8,llh8.vip,llh8.vip有你/萝莉红吧,萝莉红.萝莉红在线, 萝莉">
    <link rel="stylesheet" href="./css/style.css">
    <title>萝莉红-个人中心</title>
</head>

<body>
    <h1 style="display:none">萝莉红</h1>
    <div class="header mine">
        <div class="head-cont">
            <div class="head-lf">
                <a href="javascript:history.back(-1);" title="萝莉红">返回</a>
            </div>
            <div class="head-rf">
                <span class="refresh" onclick="getRefresh()"><img src="./img/refresh.png" alt="刷新登入" title="刷新登入"></span>
                <span id="user-account">用户</span>
                <span onclick="outLogin()"> 退出 </span>
            </div>
        </div>
    </div>
    <div class="info">
        <p><span class="label">用户名:</span><span id="user-name">无</span></p>
        <p><span class="label">会员等级:</span><span id="user-level">普通会员</span></p>
        <p><span class="label">到期时间:</span><span id="user-date">已到期</span></p>
    </div>
    <div class="ui-cnt fn-clear">
        <div class="er">
            <font color="#186209">
                打开微信，扫描下方二维码付款<br>
                <img src="./img/er.png">
            </font>
        </div>
        <div>
            <div style="font-size:16px;margin-bottom: 5px">支付步骤：↓</div>
            <strong>
                <font color="#FF0000">
                    1、长按二维码“保存图片”（iOS需手动截屏保存）<br>
                    2、打开微信“扫一扫”，从相册选取该二维码<br>
                    3、付款下方"添加备注"你的用户名（必填）<br>
                    4、充值后等待客服开通，刷新登录（准备好纸）<br>
                    5、售后客服<a target="_blank" href="//shang.qq.com/wpa/qunwpa?idkey=a7036a6c8ac63a734a7cc4d9f956fb1f531d2c228c448df77ae6c2819a5ae302"><img border="0" src="//pub.idqqimg.com/wpa/images/group.png" alt="vip售后群" title="vip售后群">789820778</a>
                </font>
            </strong>        
        </div>
    </div>
    <div class="vipchooser">
        <div class="item">
            <li class="item_top">
                <p class="title">VIP 7天(①周)</p>
                <p class="money">￥9.9</p>
            </li>
        </div>
        <div class="divmargin"></div>
        <div class="item">
            <li class="item_top">
                <p class="title">VIP 30天(①月)</p>
                <p class="money">￥26</p>
            </li>
        </div>
        <div class="divmargin"></div>
        <div class="item">
            <li class="item_top">
                <p class="title">VIP 120天(半年)</p>
                <p class="money">￥120</p>
            </li>
        </div>
        <div class="item">
            <li class="item_top">
                <p class="title">VIP 360天(①年)</p>
                <p class="money">￥200</p>
            </li>
        </div>
    </div>
    <div class="footer">警告︰本網站只這合十八歲或以上人士觀看</div>
    <script>
        function ajax() {
            var ajaxData = {
                type: arguments[0].type || "GET",
                url: arguments[0].url || "",
                async: arguments[0].async || "true",
                data: arguments[0].data || null,
                dataType: arguments[0].dataType || "text",
                contentType: arguments[0].contentType || "application/x-www-form-urlencoded",
                beforeSend: arguments[0].beforeSend || function () { },
                success: arguments[0].success || function () { },
                error: arguments[0].error || function () { }
            };
            ajaxData.beforeSend();
            var xhr = createxmlHttpRequest();
            try {
                xhr.responseType = ajaxData.dataType;
            } catch (err) {
                console.log(err)
            };
            xhr.open(ajaxData.type, ajaxData.url, ajaxData.async);
            xhr.setRequestHeader("Content-Type", ajaxData.contentType);
            xhr.send(convertData(ajaxData.data));
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4) {
                    if (xhr.status == 200) {
                        ajaxData.success(xhr.response);
                    } else {
                        ajaxData.error();
                    }
                }
            }
        };
        function createxmlHttpRequest() {
            if (window.ActiveXObject) {
                return new ActiveXObject("Microsoft.XMLHTTP");
            } else if (window.XMLHttpRequest) {
                return new XMLHttpRequest();
            }
        };
        function convertData(data) {
            if (typeof data === 'object') {
                var convertResult = "";
                for (var c in data) {
                    convertResult += c + "=" + data[c] + "&";
                }
                convertResult = convertResult.substring(0, convertResult.length - 1);
                return convertResult;
            } else {
                return data;
            }
        };
        getVaidlogin();
        var refreshed = false;
        function getVaidlogin() {
            ajax({
                type: "post",
                url: "/vdidLogin",
                success: function (data) {
                    var result = JSON.parse(data);
                    if (result.error) {
                        var user = sessionStorage.getItem('user');
                        if (user) {
                            alert('登入过期，请重新登入');
                            sessionStorage.setItem('user', '');
                        }
                        window.location.href = '/';
                    } else {
                        var userAccount = document.getElementById('user-account');
                        var userName = document.getElementById('user-name');
                        var userLevel = document.getElementById('user-level');
                        var userDate = document.getElementById('user-date');
                        userAccount.textContent = result.userName;
                        userName.textContent = result.userName;
                        if (result.endDate) {
                            var endTime = new Date(result.endDate.replace(/-/g, '/')).getTime();
                            if (endTime > new Date().getTime()) {
                                userLevel.textContent = 'VIP会员';
                                userDate.textContent = result.endDate;
                            }
                        }
                        if (!sessionStorage.getItem('user')) {
                            sessionStorage.setItem('user', data);
                        }
                    }
                },
                error: function () {
                    alert('系统异常，操作失败');
                }
            });
        }
        function outLogin() {
            ajax({
                type: "post",
                url: '/logout',
                beforeSend: function () { },
                success: function (data) {
                    var result = JSON.parse(data);
                    if (result.error) {
                        alert(result.error);
                    } else {
                        sessionStorage.setItem('user', '');
                        window.location.href = '/';
                    }
                },
                error: function () {
                    alert('系统异常，操作失败');
                }
            });
        }
        function getRefresh() {
            var rotation = document.getElementsByClassName('refresh')[0];
            rotation.querySelector('img').className = 'rotation';
            if (!refreshed) {
                refreshed = true;
                ajax({
                    type: "post",
                    url: '/refreshLogin',
                    success: function (data) {
                        console.log('刷新成功');
                        refreshed = false;
                        rotation.querySelector('img').className = '';
                    }
                });
            }
        }
    </script>
    <div style="display:none">
        统计
        <script src="https://s13.cnzz.com/z_stat.php?id=1274797422&web_id=1274797422" async="async" language="JavaScript"></script>
    </div>
</body>

</html>